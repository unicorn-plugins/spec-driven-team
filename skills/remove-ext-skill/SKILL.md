---
name: "remove-ext-skill"
description: "외부호출 스킬 제거 유틸리티"
user-invocable: true
model: "haiku"
---

# remove-ext-skill

## 목표

spec-driven-team 플러그인에서 더 이상 필요하지 않은 외부호출 스킬을 안전하게 제거함.

## 활성화 조건

- 사용자가 `/spec-driven-team:remove-ext-skill {대상플러그인명}` 형식으로 호출
- 예: `/spec-driven-team:remove-ext-skill dify`

## 워크플로우

### Step 1: 제거 대상 확인
사용자 입력에서 대상 플러그인명 추출 및 검증:
- 입력 형식: `remove-ext-skill {대상플러그인명}`
- 대상 스킬 디렉토리: `skills/ext-{대상플러그인명}/`
- 대상 스킬 파일: `skills/ext-{대상플러그인명}/SKILL.md`

존재 여부 확인:
```bash
ls skills/ext-{대상플러그인명}/SKILL.md
```

존재하지 않으면 오류 메시지 출력:
```
❌ 오류: ext-{대상플러그인명} 스킬이 존재하지 않습니다.

📋 현재 설치된 외부호출 스킬 목록:
{실제 설치된 외부호출 스킬 목록 출력}

💡 올바른 사용법:
/spec-driven-team:remove-ext-skill {기존 외부호출 스킬명}
```

### Step 2: 의존성 검사
제거할 외부호출 스킬을 참조하는 다른 스킬이 있는지 검사:

```bash
# 모든 SKILL.md 파일에서 ext-{대상플러그인명} 참조 검색
grep -r "ext-{대상플러그인명}" skills/*/SKILL.md
```

의존성이 발견되면 경고 표시:
```
⚠️ 경고: 다음 스킬들이 ext-{대상플러그인명}를 참조하고 있습니다:

📄 skills/analyze-classify/SKILL.md:
  - Step 5: AI 어플리케이션 권고 → Skill: ext-{대상플러그인명}

계속 진행하면 이들 스킬에서 오류가 발생할 수 있습니다.
```

### Step 3: 사용자 확인
제거 작업을 진행하기 전에 사용자의 최종 확인을 받음:

의존성이 없는 경우:
```
🗑️ 다음 외부호출 스킬을 제거하시겠습니까?

📁 제거될 파일: skills/ext-{대상플러그인명}/SKILL.md
🎯 대상 플러그인: {대상플러그인명}

이 작업은 되돌릴 수 없습니다.
계속하시겠습니까? (y/N)
```

의존성이 있는 경우:
```
⚠️ 위험: 다른 스킬들이 이 외부호출 스킬을 참조하고 있습니다.

강제로 제거하시겠습니까? (y/N)
제거 후 참조하는 스킬들을 수정해야 합니다.
```

### Step 4: 제거 실행
사용자가 확인하면 실제 제거 작업 수행:

1. **백업 생성**:
```bash
cp skills/ext-{대상플러그인명}/SKILL.md .omc/backups/ext-{대상플러그인명}_$(date +%Y%m%d_%H%M%S).md
```

2. **스킬 파일 제거**:
```bash
rm -f skills/ext-{대상플러그인명}/SKILL.md
rmdir skills/ext-{대상플러그인명}/ 2>/dev/null || true
```

3. **제거 로그 기록**:
`.omc/removal-log.txt`에 제거 이력 기록:
```
[2024-01-01 12:00:00] Removed ext-{대상플러그인명} skill
- Target plugin: {대상플러그인명}
- Backup: .omc/backups/ext-{대상플러그인명}_20240101_120000.md
- Dependencies: {의존성 개수}개 스킬에서 참조됨
```

### Step 5: 완료 보고 및 후속 안내
제거 작업 완료 상황을 사용자에게 보고하고 필요한 후속 작업 안내:

**성공 시**:
```
✅ 외부호출 스킬 제거 완료!

🗑️ 제거된 스킬: ext-{대상플러그인명}
💾 백업 위치: .omc/backups/ext-{대상플러그인명}_20240101_120000.md

{의존성이 있었던 경우 추가 안내}
⚠️ 후속 작업 필요:
다음 스킬들에서 제거된 스킬 참조를 수정해주세요:
- skills/analyze-classify/SKILL.md (라인 25)

🔄 복원 방법 (필요시):
cp .omc/backups/ext-{대상플러그인명}_20240101_120000.md skills/ext-{대상플러그인명}/SKILL.md
```

**실패 시**:
```
❌ 외부호출 스킬 제거 실패

원인: 파일 시스템 권한 부족 또는 파일이 사용 중

해결 방법:
1. 파일 권한 확인
2. 다른 프로세스가 파일을 사용하고 있는지 확인
3. 관리자 권한으로 재시도

💾 백업은 생성되었습니다: .omc/backups/ext-{대상플러그인명}_20240101_120000.md
```

## MUST 규칙

1. 제거 전 반드시 사용자 확인을 받아야 함
2. 제거 전 백업을 생성해야 함
3. 의존성 검사를 통해 참조하는 스킬이 있으면 경고해야 함
4. 제거 이력을 로그에 기록해야 함
5. 5단계 워크플로우를 순서대로 실행해야 함

## MUST NOT 규칙

1. 사용자 확인 없이 파일을 제거하지 않음
2. 백업 생성 실패 시에도 제거를 진행하지 않음
3. 의존성이 있어도 강제 제거 시 경고 없이 진행하지 않음
4. 제거 실패 시 부분적으로 정리하지 않음 (원자적 연산)

## 검증 체크리스트

- [ ] 대상 외부호출 스킬이 실제로 존재하는지 확인됨
- [ ] 의존성 검사가 모든 SKILL.md 파일에 대해 수행됨
- [ ] 사용자 확인 단계가 적절히 실행됨
- [ ] 백업이 정상적으로 생성됨
- [ ] 파일 제거가 원자적으로 수행됨
- [ ] 제거 로그가 올바른 형식으로 기록됨
- [ ] 의존성이 있는 경우 후속 작업이 명확히 안내됨